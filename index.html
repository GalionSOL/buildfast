<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Build.Fast Test</title>
  <script src="https://unpkg.com/@solana/web3.js@1.91.1/lib/index.iife.min.js"></script>
</head>
<body style="background: #1A1A1A; color: #FFFFFF; font-family: Arial;">
  <h1>Build.Fast Mint Test</h1>
  <button id="connect-wallet" style="background: #9945FF; color: #FFF; padding: 10px 20px; border: none;">Connect Wallet</button>
  <button id="mint-nft" style="background: #14F195; color: #000; padding: 10px 20px; border: none;">Mint NFT (0.1 SOL)</button>
  <script>
    const { Connection, PublicKey, Transaction, SystemProgram, LAMPORTS_PER_SOL } = solanaWeb3;
    let walletConnected = false;
    let publicKey;

    const connection = new Connection('https://api.devnet.solana.com', 'confirmed');
    const projectKey = new PublicKey('5YTG39q61XTnsTWGcj7gAXfrcuoFjvb78yCNRE7NvNEs');

    document.getElementById('connect-wallet').addEventListener('click', async () => {
      if (window.solana && window.solana.isPhantom) {
        try {
          const resp = await window.solana.connect();
          publicKey = resp.publicKey;
          walletConnected = true;
          console.log('Connected:', publicKey.toString());
          alert('Connected: ' + publicKey.toString());
        } catch (err) {
          console.error('Connect failed:', err);
          alert('Failed to connect: ' + err.message);
        }
      } else {
        alert('Please install Phantom Wallet!');
      }
    });

    document.getElementById('mint-nft').addEventListener('click', async () => {
      if (!walletConnected || !publicKey) {
        alert('Please connect your wallet first!');
        return;
      }

      try {
        console.log('Minting started...');
        const transaction = new Transaction().add(
          SystemProgram.transfer({
            fromPubkey: publicKey,
            toPubkey: projectKey,
            lamports: 0.1 * LAMPORTS_PER_SOL,
          })
        );

        const { blockhash } = await connection.getLatestBlockhash();
        transaction.recentBlockhash = blockhash;
        transaction.feePayer = publicKey;

        console.log('Signing transaction...');
        const signed = await window.solana.signTransaction(transaction);
        console.log('Sending transaction...');
        const signature = await connection.sendRawTransaction(signed.serialize());
        console.log('Confirming transaction...');
        await connection.confirmTransaction(signature);

        alert('Minted 0.1 SOL! Signature: ' + signature);
        console.log('Mint success:', signature);
      } catch (err) {
        console.error('Mint failed:', err);
        alert('Mint failed: ' + err.message);
      }
    });
  </script>
</body>
</html>
